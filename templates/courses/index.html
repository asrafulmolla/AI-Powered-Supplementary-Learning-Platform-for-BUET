{% extends 'base.html' %}

{% block content %}
<div class="header">
    <div class="page-title">Learning Dashboard</div>
    <div class="stats-container" style="display: flex; gap: 1rem; align-items: center;">
        <span style="color: var(--text-muted); font-size: 0.9rem;">Welcome back, <b>
                {{ user.get_role_display|default:user.username }}</b></span>
        <div class="badge" style="background: var(--primary); color: white;">{{ user.username }}</div>
    </div>
</div>

<!-- Stats Grid -->
<div class="grid" style="grid-template-columns: repeat(4, 1fr); gap: 1.5rem; margin-bottom: 2rem;">
    <div class="card" style="padding: 1.5rem; border-left: 4px solid var(--primary);">
        <div style="font-size: 2rem; font-weight: 800; color: var(--primary);">{{ stats.topics }}</div>
        <div style="color: var(--text-muted); font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px;">
            Active Topics</div>
    </div>
    <div class="card" style="padding: 1.5rem; border-left: 4px solid var(--secondary);">
        <div style="font-size: 2rem; font-weight: 800; color: var(--secondary);">{{ stats.materials }}</div>
        <div style="color: var(--text-muted); font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px;">Study
            Resources</div>
    </div>
    <div class="card" style="padding: 1.5rem; border-left: 4px solid #f59e0b;">
        <div style="font-size: 2rem; font-weight: 800; color: #f59e0b;">{{ stats.posts }}</div>
        <div style="color: var(--text-muted); font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px;">
            Community Posts</div>
    </div>
    <div class="card" style="padding: 1.5rem; border-left: 4px solid #10b981;">
        <div style="font-size: 2rem; font-weight: 800; color: #10b981;">{{ stats.ai_usage }}</div>
        <div style="color: var(--text-muted); font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px;">AI
            Generations</div>
    </div>
</div>

<div class="grid" style="grid-template-columns: 2fr 1fr; gap: 2rem;">
    <!-- Recent Activity -->
    <div>
        <div class="section-title"
            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h3>Recent Library Additions</h3>
            <a href="/generator-ui/" style="color: var(--primary); font-size: 0.9rem; text-decoration: none;">View All
                â†’</a>
        </div>
        <div class="card" style="padding: 0;">
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background: #f8fafc; border-bottom: 1px solid var(--border-color);">
                        <th style="padding: 1rem; text-align: left; color: var(--text-muted); font-size: 0.8rem;">
                            RESOURCE</th>
                        <th style="padding: 1rem; text-align: left; color: var(--text-muted); font-size: 0.8rem;">TYPE
                        </th>
                        <th style="padding: 1rem; text-align: right; color: var(--text-muted); font-size: 0.8rem;">
                            ACTION</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in recent_materials %}
                    <tr style="border-bottom: 1px solid #f1f5f9;">
                        <td style="padding: 1rem;">
                            <div style="font-weight: 600; color: var(--text-main);">{{ item.title }}</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted);">{{ item.topic.name }}</div>
                        </td>
                        <td style="padding: 1rem;">
                            <span class="badge" style="background: #e0f2fe; color: #0369a1;">
                                {{ item.file_type }}</span>
                        </td>
                        <td style="padding: 1rem; text-align: right;">
                            <a href="/material-detail/{{ item.pk }}/" class="btn-primary"
                                style="padding: 0.4rem 0.8rem; font-size: 0.8rem; text-decoration: none;">Open</a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="3" style="padding: 3rem; text-align: center; color: var(--text-muted);">No
                            resources found. Try generating some!</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Quick Actions -->
    <div>
        <h3>AI Command Center</h3>
        <div style="display: flex; flex-direction: column; gap: 1rem; margin-top: 1rem;">
            <a href="/chat-ui/" class="card"
                style="text-decoration: none; display: flex; align-items: center; gap: 1rem; padding: 1rem; transition: transform 0.2s;">
                <div
                    style="background: #ede9fe; color: #7c3aed; width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                    <i class="ri-chat-smile-2-line"></i>
                </div>
                <div>
                    <div style="font-weight: 700; color: var(--text-main);">Ask AI Anything</div>
                    <div style="font-size: 0.75rem; color: var(--text-muted);">Instant academic help</div>
                </div>
            </a>
            <a href="/digitizer-ui/" class="card"
                style="text-decoration: none; display: flex; align-items: center; gap: 1rem; padding: 1rem; transition: transform 0.2s;">
                <div
                    style="background: #dcfce7; color: #16a34a; width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                    <i class="ri-scan-line"></i>
                </div>
                <div>
                    <div style="font-weight: 700; color: var(--text-main);">Digitize Notes</div>
                    <div style="font-size: 0.75rem; color: var(--text-muted);">OCR + LaTeX formatting</div>
                </div>
            </a>
            <a href="/quiz-ui/" class="card"
                style="text-decoration: none; display: flex; align-items: center; gap: 1rem; padding: 1rem; transition: transform 0.2s;">
                <div
                    style="background: #fef3c7; color: #d97706; width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                    <i class="ri-question-answer-line"></i>
                </div>
                <div>
                    <div style="font-weight: 700; color: var(--text-main);">Take a Quiz</div>
                    <div style="font-size: 0.75rem; color: var(--text-muted);">Test your knowledge</div>
                </div>
            </a>
        </div>
    </div>
</div>

<style>
    .card:hover {
        transform: translateY(-3px);
    }
</style>
{% endblock %}